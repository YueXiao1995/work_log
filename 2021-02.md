# 			Work Log of February

---

## Week 1

---

### 02-01

* 计划
  * [x] 两阶段训练：以出版书分类作为标签构造数据集加入当前训练数据集做第一阶段训练。
  * [ ] 用上书籍前十章数据。
  * [ ] 用此套方法在网文上做一遍，出一版网文的新标签预测结果。
  * [ ] 出版书籍豆瓣标签爬取的优化和启动新一轮的爬取。（解决 在豆瓣中有对应书 但是因为书名未完全匹配导致未抓取的问题）
  * [ ] 新速看项目，产出数据中加入标签热度 
  * [x] 与审核、中台开会讨论新需求
  * [ ] 将从外部网站获取的标签加入标签体系
  * [x] 开会讨论标签扩展项目
* 完成
  * 与审核、中台开会讨论新需求
    * 具体需求： 针对每个审核人，以月为单位，统计审核总量，平均审核时长，违规、不违规的量 三个指标
  * 标签扩充项目
    * 使用fastText先进行无监督的词向量训练，之后再训练分类模型。
    * 统计使用词向量后模型预测结果、及过滤之后结果的各项指标。
    * 开会讨论项目进度
* 收获
  * 无

---

### 02-02

* 计划
  * [x] 统计使用词向量前后不同模型的预测结果、及过滤之后结果的各项指标。
  * [ ] 使用书籍人工标签做模型第一阶段训练，之后再使用豆瓣标签做第二阶段训。
  * [ ] 统计人工标签频次，过滤掉低频标签后将标签加入模型训练数据。
* 完成
  * 统计使用词向量前后不同模型的预测结果、及过滤之后结果的各项指标。
  * 由于fastText正式版本没有增量训练的功能，且github上找到的分支项目不能正常运行，故第一阶段训练放弃进行监督学习的方案。
* 收获
  * 无

---

### 02-03

* 计划
  * [x] k12机审，增加敏感词
  * [x] tags扩展项目，重新编写脚本，统计，计算项目中不同模型的效果
  * [ ] 构造一版包含过滤后的 人工关键词，tfidf关键词，人工tags，豆瓣tags的基础数据
* 完成
  * 由于运营增加的新规则，导致k12机审召回率骤降。增加敏感词，重启服务。
  * tags扩展项目，重新编写脚本，统计，计算项目中不同模型的效果。一次运行即可产出多种过滤结果，提高效率。
  * 构造一版包含过滤后的 人工关键词，tfidf关键词，人工tags，豆瓣tags的基础数据 （80%）
* 收获

  * ```bash
    cat filename | grep "xxx" -v	# 输出不含 "xxx" 的行
    ```

---

### 02-04

* 计划
  * [x] 构造一版包含过滤后的 人工关键词，tfidf关键词，人工tags，豆瓣tags的基础数据
  * [x] 使用 书名简介 和 关键词 分别训练两个fastText 模型
* 完成
  * 训练两个模型，并评估模型效果。一个模型是通过 书名和简介 预测标签，另一个则是通过 人工及tfidf关键词 预测标签。
  * 使用两个模型产出一版书籍tags
  * 由于人工关键词与标签重合度高，考虑到这可能影响模型对于tfidf关键词的学习，因此重新产出了一版不含人工关键词的数据，重新进行模型训练。
  * 由于部分书籍没有tfidf关键词，因此暂时抛弃没有tfidf的数据，重新产出一版训练数据
  * 重新训练两个模型
* 收获
  * 无

---

### 02-05

* 计划
  * [ ] 周会，周报。
  * [ ] 使用训练好的三个fasttext模型，产出三份预测结果，并进行过滤。
  * [ ] 取tfidf关键词前15， 并加上词性。
* 完成
  * 
* 收获
  * 无

---

### 02-07

* 计划
  * 
* 完成
  * 
* 收获
  * 

---

### Summary

* 本周完成
  * 两阶段训练：词向量训练，分类模型训练。由于fastText正式版本没有增量训练的功能，且github上找到的分支项目不能正常运行，故第一阶段训练放弃进行监督学习的方案。
  * 完成测试脚本，输入fastText的input和output 产出多种过滤结果，并统计相关统计数据。
  * 过滤掉低频标签，关键词，构造出一版完整的关于出版书籍的信息。
  * 训练两个模型，并评估模型效果。一个模型是通过 书名和简介 预测标签，另一个则是通过 人工及tfidf关键词 预测标签。使用两个模型产出一版预测结果。
  * 重新产出训练数据，重训两个模型。结合三个模型预测结果，产出最终版。
* 下周计划
  * [ ] 取tfidf关键词前15， 并加上词性。
  * [ ] 网易机审下架试运行，需要进行关注。
  * [ ] 使用产出出版书籍tags的方式，对于网文书籍也使用模型产出一版标签预测结果

---

## Week 2

---

### 02-08

* 计划
  * [x] 开发脚本，本产出网文书籍的基础数据集
  * [x] 针对网文书籍的fasttext模型训练
* 完成
  * 完成脚本开发并产出数据集
  * 构造训练数据，使用类似出版书籍的三种方式进行模型训练，最终产出三个模型
* 收获
  * 无

---

### 02-09

* 计划
  * [x] 使用三种模型产出网文书的标签并根据阈值进行过滤。
  * [x] 融合三种模型的结果，并产出一版完整的数据
* 完成
  * 使用三种模型产出网文书的标签并根据阈值进行过滤。
  * 融合三种模型的结果，并产出一版完整的数据。直观来看效果不错
* 收获
  * 无

---

### Summary

* 本周完成
  * 
* 下周计划
  * 

---

## Week 3

---

### 02-18

* 计划

  * [x] 查找机审例行统计邮件发送失败的原因，重新发送邮件

* 完成

  * 查找机审例行统计邮件发送失败的原因，重构统计项目。重跑过去一周每一天的统计，并发送邮件。
    * 重构后的项目可以统计并发送2021-02-08后任意一天的统计邮件

* 收获

  * `strptime` 和 `strftime` 的用法

    * ```python
      from datatime import datatime
      str_date = "2020-01-01"
      # str to datetime object
      date = datetime.strptime(str_date, "%Y-%m-%d") 
      # datetime object to str
      date = datetime.strftime("%Y-%m-%d")
      ```

---

### 02-19

* 计划

  * [ ] 整理书籍标签扩展项目代码
    * 基础数据更新
    * 训练数据生成
    * 模型训练
    * 使用模型产出书籍标签
    * 为每个标签挑选合适阈值，过滤产出的产出的标签
    * 融合过滤后的标签

  * [ ] 新速看标签映射项目
    * 根据运营产出的数据，调整部分书籍的标签映射结果
    * 将结果交付数据平台进行灰度测试

* 完成

  * 整理书籍标签扩展项目代码（进度约30%）
    * 完成基础数据，中间结果，及最终产出数据的整理

* 收获

  * 无

---

### 02-20

* 计划

  * [ ] 整理书籍标签扩展项目代码
    * 基础数据更新
    * 训练数据生成
    * 模型训练
    * 使用模型产出书籍标签
    * 为每个标签挑选合适阈值，过滤产出的产出的标签
    * 融合过滤后的标签

  * [x] 新速看标签映射项目
    * 根据运营产出的数据，调整部分书籍的标签映射结果
    * 将结果交付数据平台进行灰度测试
* 完成
  * 新速看标签映射项目
    * 根据运营产出的数据，调整部分书籍的标签映射结果
    * 将结果交付数据平台进行灰度测试
* 收获
  * 无

---

### Summary

* 本周完成
* 下周计划

---

## Week 4

---

### 02-22

* 计划
  * [x] 新速看项目 加入人工干预后的结果上线到正式环境
  * [ ] 整理书籍标签扩展项目代码
    * [ ] 基础数据更新
    * [x] 训练数据生成
    * [ ] 模型训练
    * [ ] 使用模型产出书籍标签
    * [ ] 为每个标签挑选合适阈值，过滤产出的产出的标签
    * [ ] 融合过滤后的标签
* 完成
  * 新速看项目 加入人工干预后的结果上线到正式环境
  * 更新k12敏感词词库，重启机审服务
  * 运维下线一批服务器，查找修改机审项目中的相关ip地址
  * 整理书籍标签扩展项目代码 (进度20%)
* 收获
  * 无

---

### 02-23

* 计划
  * 整理书籍标签扩展项目代码
    * [x] 模型训练
    * [ ] 基础数据更新
    * [ ] 使用模型产出书籍标签
    * [ ] 为每个标签挑选合适阈值，过滤产出的产出的标签
    * [ ] 融合过滤后的标签
* 完成
  * 整理书籍标签扩展项目的模型训练部分代码 （进度50%）
  * 开会讨论标签扩展项目
  * 比较泛化词及模型两种技术路线产出的书籍标签，研究融合方案
  * 产出一版merge后的数据，查看效果，进行对比。
* 收获
  * 无

---

### 02-24

* 计划
  * [ ] 整理书籍标签扩展项目代码
    * [x] 基础数据更新
    * [x] 使用模型产出书籍标签
    * [ ] 为每个标签挑选合适阈值，过滤产出的产出的标签
    * [ ] 融合过滤后的标签
  * [ ] 机器审核，构想是否可以通过汉字与拼音的对应关系，来得到敏感词的拼音表示，首字母缩写表示，或混合型。进而提高敏感 词的是识别率。
  * [ ] 书籍标签扩展项目，在产出标签后的过滤，融合过程中，保留模型计算的分数，使用该分数与泛化词结果进行融合
* 完成
  * 整理书籍标签扩展项目代码 （进度60%）
    * 使用模型产出书籍标签
  * 查找机审昵称检测涉黄没有被识别的问题
    * 结论：由于请求参数及审核逻辑导致
  * 为运营导出二级三级分类id。
* 收获
  * 无

---

### 02-25

* 计划
  * [ ] 整理，重构书籍标签扩展项目代码
  * [ ] 产出一版融合后的标签
* 完成
  * 整理、重构标签预测、标签过滤、标签融合部分的代码 （进度90%）
    * 针对每个模型产出的结果，为每个标签挑选合适阈值，过滤产出的产出的标签
  * 统计、导出机审风险识别功能上线后，低中高风险消息中各自有多少违规信息
* 收获
  * 无

---

### 02-26

* 计划
  
  * 整理，重构书籍标签扩展项目代码
  * 产出一版融合后的标签
  
* 完成

  * 整理，重构书籍标签扩展项目代码
  * 产出一版融合后的出版标签
  * 开会讨论标签拓展项目

* 收获

  * ```bash
    # 截取两列并调换两列的顺序
    awk -F '\t' '{print $2"\t"$1}' filename
    ```

---

### Summary

* 本周完成

  * 新速看项目，调整部分书籍的标签映射结果，进行灰度测试后上线。
* 整理书籍标签扩展项目代码，并进行重构。
  * 产出一版融合后的出版标签。

* 下周计划

  * 产出一版融合后的网文标签
  * 开发机审安全策略（政治敏感）

---

## Summary of Feburary

